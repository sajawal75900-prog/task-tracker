<h2 mat-dialog-title>Create Task</h2>

<form [formGroup]="taskForm" mat-dialog-content>

  <!-- Project -->
  <mat-form-field appearance="outline" class="w-full">
    <mat-label>Project</mat-label>
    <mat-select formControlName="projectUlId">
      <mat-option>
        name
      </mat-option>
    </mat-select>
    <mat-error *ngIf="taskForm.get('projectUlId')?.invalid">
      Project is required
    </mat-error>
  </mat-form-field>

  <!-- Title -->
  <mat-form-field appearance="outline" class="w-full">
    <mat-label>Title</mat-label>
    <input matInput formControlName="title" />
  </mat-form-field>

  <!-- Description -->
  <mat-form-field appearance="outline" class="w-full">
    <mat-label>Description</mat-label>
    <textarea matInput rows="3" formControlName="description"></textarea>
  </mat-form-field>

  <!-- Status / Column -->
  <mat-form-field appearance="outline" class="w-full">
    <mat-label>Status</mat-label>
    <mat-select formControlName="columnId">
      <mat-option *ngFor="let col of filteredColumns" [value]="col.id">
        {{ col.name }}
      </mat-option>
    </mat-select>
    <mat-hint *ngIf="!filteredColumns.length">
      Create columns for this project first
    </mat-hint>
  </mat-form-field>

  <!-- Priority & Type -->
  <div class="grid grid-cols-2 gap-4">
    <mat-form-field appearance="outline">
      <mat-label>Priority</mat-label>
      <mat-select formControlName="priority">
        <mat-option *ngFor="let p of priorityOptions" [value]="p">
          {{ p }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Type</mat-label>
      <mat-select formControlName="type">
        <mat-option *ngFor="let t of typeOptions" [value]="t">
          {{ t }}
        </mat-option>
      </mat-select>
    </mat-form-field>
  </div>
  <app-tag-input-control
  [options]="usersList"
  displayKey="name"
  placeholder="Select Users"
  (selectionChange)="onAssignedUsersChange($event)"
  ></app-tag-input-control>

</form>

<mat-dialog-actions align="end">
  <button mat-stroked-button type="button" (click)="close()">Cancel</button>
  <button
    mat-flat-button
    color="primary"
    [disabled]="taskForm.invalid"
    (click)="submit()">
    Create
  </button>
</mat-dialog-actions>
